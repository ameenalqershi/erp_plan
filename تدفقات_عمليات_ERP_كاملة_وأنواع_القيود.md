# توضيح كامل ودقيق لتدفقات العمليات وأنواع القيود (المتكامل بلس + الأونكس برو)

---

## 1. تدفقات العمليات المالية

### أ. دورة المشتريات

#### الخطوات التفصيلية:
1. **تسجيل طلب شراء (Purchase Requisition)**
   - الموظف المختص أو القسم يحدد الأصناف والكميات المطلوبة، والأسباب، وأولوية الطلب.
   - يتم اختيار الموازنة المرتبطة، مركز التكلفة، والمشروع إن وجد.
   - الطلب يمر بتسلسل موافقات إلكتروني (توقيع إلكتروني، مدير مباشر، مدير مالي، إدارة عليا).
   - يتم حفظ تاريخ ووقت كل موافقة ورفض مع التعليق.

2. **تجميع طلبات الشراء (Consolidation)**
   - النظام أو المسؤول يجمع طلبات متعددة لنفس الصنف أو المورّد في طلب مركزي (لتخفيض التكاليف/رفع الكفاءة).
   - تصدر قائمة بالأصناف والكميات المجمعة.

3. **إعداد استفسار عروض أسعار (RFQ - Request for Quotation)**
   - إرسال استفسار أسعار للموردين المعتمدين (إلكترونيًا أو يدويًا).
   - تسجيل تواريخ إرسال واستلام العروض، وأرقام الوثائق المرفقة (PDF/Excel).
   - النظام يتيح مقارنة العروض تلقائيًا (سعر، مدة توريد، شروط دفع، جودة).

4. **تقييم العروض (Quotation Evaluation)**
   - لجنة المشتريات أو النظام يقيّم العروض بناءً على معايير: السعر، الجودة، مدة التسليم، السمعة، شروط الدفع، الضمان.
   - يولّد تقرير تقييم مفصل، مع إمكانية إرفاق ملاحظات خبراء أو لجان.

5. **إصدار أمر شراء (Purchase Order)**
   - تحويل العرض الفائز مباشرة إلى أمر شراء رسمي.
   - ربط أمر الشراء بموازنة، مركز تكلفة، مشروع، فرع.
   - أمر الشراء يصدر برقم تسلسلي، ويُرسل للمورد إلكترونيًا (PDF، Email)، مع شروط التوريد والدفع.

6. **استلام الأصناف (Goods Receipt Note - GRN)**
   - عند استلام الأصناف في المخازن:
     - تسجيل الكميات الفعلية، الأرقام التسلسلية/الدفعات، تواريخ الصلاحية.
     - فحص الجودة (QA/QC)، تسجيل نتائج الفحص (مقبول/مرفوض/مع ملاحظات).
     - النظام يُتيح رفض جزئي/كلي للأصناف غير المطابقة مع تسجيل السبب.
     - التوقيع الإلكتروني للمستلم والمراجع.

7. **تحديث المخزون**
   - تسجيل حركة إدخال مخزون تلقائي:
     - تحديث أرصدة الأصناف في المخزن والمستودع الفرعي.
     - تحديث بيانات الدُفعات، تواريخ الانتهاء، مواقع التخزين الدقيقة.
     - تحديث الأعمار، الحد الأدنى، سياسات إعادة الطلب.
     - تسجيل التاريخ، المستخدم، رقم أمر الشراء المرتبط بالحركة.

8. **إثبات الفاتورة (Purchase Invoice)**
   - تسجيل فاتورة المورد (إدخال رقم فاتورة المورد، التاريخ، المرفقات).
   - النظام يطابق تلقائيًا: أمر الشراء، الاستلام، الفاتورة (3-way matching).
   - معالجة الفروق: كميات/سعر/ضريبة/مصاريف إضافية (شحن، تأمين).
   - إمكانية تسجيل ملاحظات على الفاتورة أو الاعتراضات.
   - ربط الفاتورة بشروط الدفع وجدولة السداد (دفعة واحدة/تقسيط/مؤجل).

9. **الترحيل المحاسبي (القيد المالي)**
   - النظام يولّد القيد المحاسبي تلقائيًا بناءً على إعدادات الحسابات:
     - مدين: مخزون/مصاريف/ضريبة مدخلة/مصاريف شحن/مركز تكلفة.
     - دائن: حساب المورد/ذمم دائنة/ضريبة مورد.
     - تسجيل رقم القيد، التاريخ، المستخدم، ارتباطه بالفاتورة والمخزن.
   - حفظ القيد في دفتر اليومية، إمكانية تعديله (بصلاحيات خاصة)، سجل التعديلات.

10. **إدارة السداد (Payment Management)**
    - مراجعة الفواتير المستحقة حسب شروط الدفع.
    - إصدار أمر دفع (سند صرف) بنكي/شيك/نقدي/تحويل إلكتروني.
    - دورة موافقات إلكترونية للسداد (مدير مالي/مدير عام/مراجعة داخلية).
    - توليد القيد المحاسبي تلقائيًا لسند الصرف:
      - مدين: المورد/ذمم دائنة
      - دائن: البنك/الصندوق/شيكات تحت الصرف
    - ربط السند بالفاتورة/الفواتير المسددة، تحديث حالة الذمم، سجل السداد.

11. **التقارير والتدقيق**
    - استخراج تقارير دورية: أوامر شراء، فواتير، استلامات، أرصدة الموردين، تحليل الأسعار، أداء الموردين، تقارير انحرافات الكميات/الأسعار، تقارير مطابقة 3-way.
    - تقارير تدقيق: سجل الموافقات، تاريخ التعديلات، مقارنة الفواتير والاستلامات.

---

### ب. دورة المبيعات والتحصيل

#### جميع الخطوات التفصيلية:
1. **تسجيل العميل (Customer Registration)**
   - إدخال بيانات العميل كاملة: هوية، عناوين، تصنيفات، قائمة أسعار مخصصة، شروط دفع، سجل ائتماني، حدود ائتمان، ربط عروض وخصومات.

2. **تقديم عرض سعر (Quotation)**
   - تحديد الأصناف، الكميات، الأسعار، شروط الدفع والتسليم، الضرائب، الخصومات.
   - إصدار عرض سعر برقم تسلسلي، ربطه بالعميل والفترة الزمنية.
   - إرسال العرض (Email، PDF، SMS)، حفظ سجل الإرسال.

3. **تحويل العرض إلى أمر بيع (Sales Order)**
   - موافقة العميل إلكترونيًا (توقيع رقمي أو رد رسمي)، أو يدويًا.
   - تحويل العرض مباشرة إلى أمر بيع مع الاحتفاظ بالتسلسل المرجعي.
   - تدقيق حدود ائتمان العميل آليًا، إشعار فوري إذا تجاوز الحد أو لديه مستحقات متأخرة.

4. **حجز الأصناف (Stock Reservation)**
   - حجز الكمية المطلوبة من المخزون لصالح أمر البيع، ربطها بالطلب وتحديد تاريخ انتهاء الحجز.

5. **تجهيز/شحن البضاعة (Delivery/Shipment)**
   - إصدار إذن صرف (Delivery Note)، تحديد المخزن، المسؤول عن التحضير، وسيلة النقل، حالة التعبئة.
   - فحص جاهزية الأصناف (QC)، تسجيل أرقام الدُفعات والتسلسل إن وجدت.
   - تسجيل خروج البضاعة من المخزن مع رقم إذن الصرف، تحديث أرصدة الأصناف، الموقع الفعلي للشحن.

6. **إصدار فاتورة البيع (Sales Invoice)**
   - ربط الفاتورة بأمر البيع، إذن الصرف، العميل، قائمة الأسعار المعتمدة، الضرائب، الخصومات.
   - إمكانية تقسيم الفاتورة لشحنات جزئية أو فواتير مجمعة.
   - دعم الفواتير الإلكترونية (QR Code، توقيع رقمي، إرسال تلقائي).

7. **إثبات القيد المحاسبي (الترحيل المالي)**
   - إنشاء القيد تلقائيًا:
     - مدين: حساب العميل/ذمم مدينة/ضريبة مخرجة.
     - دائن: إيرادات/خصومات/ضريبة/مخزون (تكلفة البضاعة المباعة COGS).
   - قيد تكلفة البضاعة المباعة يتم آلياً (مدين COGS، دائن مخزون)، مع دعم طرق التسعير (متوسط، وارد أولاً، إلخ).
   - حفظ القيد في دفتر اليومية، سجل رقم العملية، المستخدم، رقم الفاتورة.

8. **التحصيل والمدفوعات (Collection)**
   - إصدار سند قبض (نقدي/شيك/تحويل/بطاقة).
   - ربط السند بالفاتورة/الفواتير المسددة.
   - دورة موافقات إلكترونية (حسب المبلغ/العميل/الفرع).
   - قيد محاسبي تلقائي:
     - مدين: بنك/صندوق/شيكات واردة.
     - دائن: عميل/ذمم مدينة.

9. **إدارة الذمم والتحصيلات**
   - متابعة تواريخ الاستحقاق، إرسال تنبيهات آلية (Email/SMS).
   - جدولة التحصيلات (دفعات جزئية/تقسيط).
   - معالجة التحصيلات الجزئية، أرصدة العملاء، احتساب الفوائد/غرامات التأخير عند اللزوم.

10. **تسويات العملاء (Credit/Debit Notes)**
    - إصدار إشعارات دائن/مدين (خصومات بعد البيع، تعويضات، استرجاع).
    - ربط الإشعار بالفواتير أو سندات القبض.

11. **التقارير والتحليل**
    - تقارير المبيعات حسب (العميل، الصنف، المنطقة، البائع، الفرع، الفترة).
    - تقارير أعمار الذمم، تحليل الأداء البيعي، تقارير الأرباح.
    - سجل العمليات والتدقيق (Audit Trail).

---

### ج. دورة المخزون (عمليات المخزون الكاملة)

#### جميع العمليات:
1. **إضافة صنف جديد (Item Master)**
   - تعريف الصنف: كود، اسم، مجموعة، وحدات قياس متعددة، باركود، حد أدنى، مواقع تخزين، صور، مواصفات فنية.
   - ربط الصنف بقوائم أسعار، موردين معتمدين، ضريبة، وحدات تحويل، سياسة تسعير.

2. **تسجيل حركة إدخال مخزون (Stock In)**
   - مصدر: مشتريات، إنتاج، مرتجع مبيعات، تسوية جرد بالزيادة، هدية/تبرع.
   - إدخال بيانات الدفعة (Batch/Lot/Serial)، تواريخ الصلاحية، الموقع الدقيق، مسؤول الحفظ.
   - توثيق السبب، رقم المرجع (فاتورة/سند/إنتاج)، توقيعات الأطراف.

3. **تسجيل حركة إخراج مخزون (Stock Out)**
   - سبب الإخراج: بيع، استهلاك إنتاج، هالك، مرتجع مشتريات، تسوية جرد بالنقص.
   - تسجيل حركات الإخراج بالتفصيل (الكمية، الدفعة، الموقع، تاريخ الإخراج).
   - ربط الإخراج بالعميل أو أمر إنتاج، سند مرجعي، الموافقات المطلوبة.

4. **تحويل مخزون بين المخازن (Stock Transfer)**
   - إصدار أمر تحويل، تحديد المخزن المصدر والمستلم.
   - تسجيل حركة خروج في المصدر، دخول في المستقبل.
   - تتبع حالة التحويل (قيد التنفيذ، مكتمل، مرفوض)، توثيق النقل، توقيعات المستلمين.

5. **الجرد والتسويات (Inventory Counting & Adjustments)**
   - جدولة جرد دوري/فجائي، تعيين لجان جرد.
   - إدخال نتائج الجرد الفعلية، مقارنة مع النظام.
   - معالجة الفروقات (زيادة/نقص)، إصدار سند تسوية.
   - تسجيل سبب الفروقات، الملاحظات، الموافقات الإدارية.

6. **حجز المخزون (Reservation)**
   - حجز كميات لصالح أوامر بيع أو إنتاج.
   - تحرير الحجز تلقائياً عند الإلغاء أو الإتمام.

7. **إدارة الدُفعات (Batch/Lot/Serial)**
   - تتبع كامل لكل دفعة/رقم تسلسلي، تاريخ الصلاحية، المورد، الموقع.
   - تقارير سحب الدفعات، إنذارات انتهاء الصلاحية.

8. **التقارير**
   - أرصدة المخزون، حركة الصنف، تقييم المخزون (طرق تسعير متعددة)، تقارير أعمار المخزون، تقارير الجرد، تحليل الفروقات، تقارير أصناف بطيئة الحركة.

---

### د. دورة الأصول الثابتة

#### جميع العمليات:
1. **تعريف أصل جديد (Asset Registration)**
   - إدخال بيانات الأصل: كود، اسم، رقم تسلسلي، تصنيف، جهة استخدام، موقع، تاريخ شراء، قيمة الشراء، مورد، ضمانات، صور ومستندات.
   - ربط الأصل بمركز تكلفة، مشروع، فرع.

2. **إثبات شراء أصل**
   - ربط الأصل بفاتورة الشراء، أمر الشراء، تسجيل سند الاستلام.
   - قيد مالي: مدين أصول ثابتة، دائن مورد/صندوق/بنك.

3. **جدولة وإثبات الاهلاك (Depreciation)**
   - تحديد طريقة الاهلاك (خط مستقيم، متناقص، مخصص)، العمر الافتراضي، قيمة التخريد.
   - النظام يحتسب الاهلاك آليًا (شهري/سنوي)، يولد قيد مالي:
     - مدين: مصروف إهلاك
     - دائن: مجمع إهلاك
   - سجل تواريخ الاهلاك، تفاصيل القيد، ارتباطه بالأصل، مركز التكلفة.

4. **نقل/استبعاد/بيع الأصل**
   - نقل بين الفروع/المواقع (تعديل الموقع، تحديث السجلات).
   - بيع الأصل: تسجيل بيانات البيع، المشتري، السعر، توثيق العملية، قيد محاسبي (شطب القيمة الدفترية، إثبات الربح/الخسارة).
   - استبعاد الأصل: توثيق السبب، الموافقات.

5. **الصيانة الدورية والعمرية**
   - جدولة صيانة وقائية/تصحيحية، تسجيل التكاليف، ربطها بالأصل والمصاريف.
   - سجل تاريخي لصيانة كل أصل، تقارير أداء.

6. **جرد الأصول**
   - جرد دوري للأصول، مطابقة السجلات الفعلية مع النظام، معالجة الفروقات.

7. **التقارير**
   - سجل الأصول، تقارير الاهلاك، تقارير الصيانة، جرد الأصول، تقارير الأصول حسب الموقع/الحالة/الفرع.

---

### هـ. دورة الموارد البشرية والرواتب

#### جميع العمليات:
1. **إضافة/تحديث موظف (Employee Management)**
   - بيانات شخصية، وظيفية، عقود، مؤهلات، مستندات رسمية، ملفات مرفقة.
   - ربط الموظف بقسم، وظيفة، مشرف مباشر، فرع.

2. **إدارة الحضور والانصراف (Attendance)**
   - نظام تسجيل حضور يدوي/بصمة/بطاقة/تطبيق موبايل.
   - جدولة الورديات، تسجيل الإجازات الرسمية، تصاريح الخروج المؤقت.
   - معالجة التأخيرات، الغيابات، الإضافي، الربط تلقائياً بمسير الرواتب.

3. **إدارة الإجازات والسلف والقروض**
   - تقديم طلب إجازة إلكتروني، مرورها بسلسلة موافقات.
   - جدولة السلف والقروض، ربطها بخصومات الرواتب، سجل عمليات السداد.

4. **إعداد وصرف الرواتب (Payroll)**
   - تجهيز مسير الرواتب: الراتب الأساسي، البدلات، الحوافز، العلاوات، الاستقطاعات (تأمينات، ضريبة، غرامات، قروض).
   - مراجعة واعتماد المسير، إصدار أوامر الدفع (بنكي، نقدي، شيك).
   - قيد مالي تلقائي:
     - مدين: مصروف رواتب/بدلات/حوافز
     - دائن: بنك/صندوق/مستحقات موظفين/جهات رسمية.
   - سجل تاريخ الصرف، المستخدم، المرفقات.

5. **التقييمات والترقيات**
   - تقييم الأداء حسب معايير محددة، ربط النتائج بالترقية/الحوافز/المكافآت.

6. **التقارير**
   - تقارير الموظفين، الحضور، الغياب، الإجازات، الرواتب، التقييمات، تحليل المصروفات البشرية.

---

### و. دورة التصنيع (في الأنظمة الداعمة)

#### جميع العمليات:
1. **إعداد BOM (هيكلة المنتج)**
   - تعريف المواد الخام، الكميات، المراحل، مراكز العمل، التكاليف التقديرية.

2. **إصدار أمر تصنيع (Manufacturing Order)**
   - تحديد المنتج النهائي، الكمية، المواد الخام المطلوبة، الجدول الزمني.
   - ربط الأمر بمركز تكلفة، مشروع، فرع، مسؤول إنتاج.

3. **صرف المواد الخام (Material Issue)**
   - سحب الخامات من المخزون، ربطها بأمر التصنيع.
   - قيد مالي: مدين إنتاج تحت التشغيل (WIP)، دائن مخزون خامات.

4. **تصنيع المنتج النهائي**
   - تسجيل المراحل المنجزة، الفاقد، الهالك، الكميات المنتجة.
   - إضافة المنتج النهائي/شبه النهائي للمخزون.
   - قيد مالي: مدين مخزون منتج نهائي، دائن إنتاج تحت التشغيل.

5. **احتساب كلفة الإنتاج**
   - مواد خام، أجور عمال، طاقة، مصاريف غير مباشرة.
   - توزيع الكلفة بدقة على المنتجات، ربطها بالقيود المالية.

6. **تقارير التصنيع**
   - أوامر التصنيع، الإنتاجية، كلفة المنتج، الفاقد، تحليل الانحرافات.

---

### ز. الإدارة والصلاحيات

#### جميع العمليات:
1. **إدارة المستخدمين والصلاحيات**
   - إضافة مستخدم، تعيين أدوار وصلاحيات (حسب الشاشة/العملية/الفرع/المخزن).
   - سجل دخول وخروج، تتبع العمليات الحرجة.

2. **سجلات التدقيق (Audit Trail)**
   - سجل لكل عملية: التعديل، الحذف، الموافقة، تغيير الصلاحيات، طباعة التقارير، إرسال البريد.

3. **الإشعارات والتنبيهات**
   - تنبيهات تلقائية للعمليات الحساسة: موافقات، تجاوز حد ائتمان، انتهاء صلاحية، تأخير سداد، انتهاء صلاحية أصل أو مادة.

---

## 2. قائمة جميع أنواع القيود في النظام

### أ. القيود المالية (Accounting Entries)
| العملية                      | مدين                                   | دائن                                   | ملاحظات                                     |
|------------------------------|----------------------------------------|----------------------------------------|----------------------------------------------|
| فاتورة مشتريات               | مخزون/مصروفات/ضريبة مدخلة/مصاريف شحن | المورد/ذمم دائنة/ضريبة مورد           | آلي من فاتورة الشراء                        |
| سند صرف لمورد/دفع فاتورة     | المورد/ذمم دائنة                      | بنك/صندوق/شيكات تحت الصرف             | آلي من سند الصرف                            |
| فاتورة مبيعات                | عميل/ذمم مدينة/ضريبة مخرجة            | إيرادات/خصومات/ضريبة/مخزون (COGS)     | آلي من فاتورة البيع                         |
| سند قبض من عميل              | بنك/صندوق/شيكات واردة                 | عميل/ذمم مدينة                         | آلي من سند القبض                            |
| مرتجع مبيعات                 | مبيعات/ضريبة مخرجة                    | عميل                                    | آلي من مرتجع بيع                            |
| مرتجع مشتريات                | مورد                                   | مشتريات/ضريبة مدخلة                    | آلي من مرتجع شراء                           |
| حركة مخزون (زيادة/نقصان)     | مخزون أو أرباح/خسائر رأسمالية         | مقابله                                 | آلي من تسوية جرد                            |
| الرواتب                      | مصروف رواتب/بدلات/حوافز              | بنك/صندوق/مستحقات موظفين/جهات رسمية   | آلي من مسير الرواتب                         |
| قيد إهلاك أصل                | مصروف إهلاك                           | مجمع إهلاك                              | آلي من جدول الإهلاك                         |
| شراء أصل ثابت                | أصل ثابت                              | مورد/صندوق/بنك                         | آلي من فاتورة شراء أصل                      |
| بيع أصل ثابت                 | بنك/صندوق/عميل                        | أصل ثابت/مجمع إهلاك/أرباح أو خسائر بيع | آلي من بيع الأصل                            |
| أمر تصنيع (صرف خامات)        | إنتاج تحت التشغيل                     | مخزون خامات                            | آلي من أمر التصنيع                          |
| منتج نهائي من تصنيع          | مخزون منتجات تامة                     | إنتاج تحت التشغيل                      | آلي من استلام المنتج النهائي                |
| قيد ضريبة تلقائي             | ضريبة مدخلة/مخرجة                     | ضريبة مستحقة/حساب حكومي                | آلي من الفواتير                             |
| تسوية بنكية                  | بنك/حساب تسوية                        | حساب بنكي                               | بعد مطابقة البنك                            |
| قيد إقفال سنوي               | الأرباح والخسائر                       | كافة حسابات الإيرادات والمصروفات        | آلي بنهاية السنة المالية                    |
| قيد تحويل عملة               | أرباح/خسائر فروق عملة                 | تقييم عملة                              | آلي من فروق العملة                          |

### ب. قيود غير مالية (Operational/Stock/HR/Other)
| العملية                      | نوع القيد         | التأثير                         | ملاحظات                       |
|------------------------------|-------------------|----------------------------------|-------------------------------|
| تحويل مخزون بين مخازن        | حركة مخزون        | تعديل رصيد فقط                   | ليس مالي إذا نفس الشركة       |
| حجز مخزون                   | حجز               | منع صرف الكمية المحجوزة          | دون حركة مالية               |
| تسوية جرد مخزون             | تسوية مخزون       | تعديل أرصدة وإصدار سند تسوية     | القيد المالي حسب السياسة      |
| إجازة/سلف/قرض للموظف         | HR                | رصيد الإجازات/السلف/القروض      | القيد المالي عند الصرف        |
| تقييم موظف                   | HR                | ملف التقييم فقط                  | يؤثر على الحوافز/الترقيات    |
| تعديل صلاحية مستخدم          | صلاحيات           | لا يؤثر ماليًا                   | يظهر في سجل التدقيق          |
| إشعار دائن/مدين              | ذمم               | تعديل رصيد عميل/مورد             | قيد مالي عند الترحيل          |
| إشعار/تنبيه نظامي            | إشعارات           | لا يؤثر ماليًا                   | يظهر في لوحة الإشعارات        |

---

## 3. توثيق أمثلة قيود فعلية (نماذج عملية)

### مثال 1: قيد فاتورة مشتريات (100,000 + 15% ضريبة)
- مدين: مخزون (100,000)
- مدين: ضريبة مدخلة (15,000)
- دائن: المورد (115,000)

### مثال 2: قيد صرف راتب موظف
- مدين: مصروف رواتب (4,000)
- دائن: بنك (4,000)

### مثال 3: قيد بيع أصل ثابت (القيمة الدفترية 20,000، بيع بسعر 18,000)
- مدين: بنك (18,000)
- مدين: مجمع إهلاك (مثلاً 10,000)
- مدين: خسارة بيع أصل (2,000)
- دائن: أصل ثابت (30,000)

---

# ملحق: جميع القيود قابلة للبحث، التدقيق، الطباعة، التصدير، الربط بالعمليات المرجعية (رقم الفاتورة/الطلب/الفرع/المستخدم/التاريخ).

---

**هذا التحليل يمثل تدفق العمليات والقيود كما يحدث فعليًا في الأنظمة المحاسبية والإدارية الكبرى دون أي اختصار أو تبسيط.  
إن أردت تدفق عملية أخرى (مثلاً الموازنات، المشاريع، العقود)، أو توثيق نماذج قيود أكثر تفصيل، أو توضيح علاقة كل قيد بجدول في قاعدة البيانات، يرُجى تحديد ذلك.**